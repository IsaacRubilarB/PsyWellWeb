<app-navbar></app-navbar>

<div class="notas-header">
  <img src="assets/logo.png" alt="Logo PsyWell" class="logo" />
  <h1>Centro de Notas y Seguimiento</h1>
</div>

<div class="notas-container">
  <!-- Barra de búsqueda -->
  <div class="search-bar">
    <input type="text" placeholder="Buscar nota o recordatorio..." [(ngModel)]="searchQuery" (input)="filterNotes()" />
  </div>

  <!-- Categorías de Notas -->
  <div class="section">
    <div class="section-header">
      <h2>Notas Categorizadas</h2>
      <button (click)="toggleFavoritesOnly()">
        <i class="fas fa-star" [class.favorited]="showFavoritesOnly"></i> Ver Favoritos
      </button>
    </div>
    <div class="form-inputs">
      <input type="text" [(ngModel)]="newNoteTitle" placeholder="Título de la nota..." />
      <textarea [(ngModel)]="newNoteContent" placeholder="Escribe tu nota..."></textarea>
      <select [(ngModel)]="newNoteCategory">
        <option value="observacion">Observación</option>
        <option value="seguimiento">Seguimiento</option>
        <option value="tarea">Tarea</option>
      </select>
      <button (click)="addNote()">Añadir Nota</button>
    </div>
    <div class="note-grid">
      <div *ngFor="let note of filteredNotes" class="note-card" [ngClass]="note.category">
        <h3>{{ note.title }}</h3>
        <p>{{ note.content }}</p>
        <div class="note-actions">
          <button (click)="toggleFavorite(note)">
            <i class="fas fa-star" [class.favorited]="note.favorite"></i> Favorito
          </button>
          <button (click)="deleteNote(note)">Eliminar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Seguimiento de Pacientes -->
  <div class="section">
    <h2>Seguimiento de Pacientes</h2>
    <div class="form-inputs">
      <select [(ngModel)]="selectedPatient" (change)="loadPatientSessions()">
        <option *ngFor="let patient of patients" [ngValue]="patient">{{ patient.name }}</option>
      </select>
      <textarea [(ngModel)]="newSessionNote" placeholder="Escribe una nota para esta sesión..."></textarea>
      <button (click)="addSessionNote()">Añadir Nota de Sesión</button>
    </div>
    <div class="session-list" *ngIf="selectedPatientSessions.length > 0">
      <div *ngFor="let session of selectedPatientSessions" class="session-card">
        <h4>{{ session.date | date:'shortDate' }} - {{ session.notes }}</h4>
      </div>
    </div>
  </div>

  <!-- Recordatorios -->
  <div class="section">
    <h2>Recordatorios</h2>
    <div class="form-inputs">
      <input type="text" [(ngModel)]="newReminder" placeholder="Descripción del recordatorio" />
      <input type="date" [(ngModel)]="newReminderDate" />
      <button (click)="addReminder()">Añadir Recordatorio</button>
    </div>
    <div class="reminder-list">
      <div *ngFor="let reminder of reminders" class="reminder-card">
        <h4>{{ reminder.text }} - {{ reminder.date | date:'shortDate' }}</h4>
        <button (click)="deleteReminder(reminder)">Eliminar</button>
      </div>
    </div>
  </div>
</div>

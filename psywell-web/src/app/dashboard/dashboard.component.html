<app-navbar></app-navbar>

<div class="dashboard-container">
  <!-- Contenedor principal del dashboard -->
  <div class="header">
    <img src="assets/logo.png" alt="PsyWell Logo" class="logo" />
    <h1 class="welcome-message">
      Bienvenid{{ genero === 'femenino' ? 'a' : 'o' }},
      <ng-container *ngIf="genero === 'femenino'; else masculino">Dra.</ng-container>
      <ng-template #masculino>Dr.</ng-template>
      {{ psicologoName }}
    </h1>
  </div>

  <!-- Perfil y Portada -->
  <div class="profile-summary" [style.backgroundImage]="fondoPerfil || 'url(assets/default-cover.jpg)'">
    <!-- Foto de Perfil -->
    <div class="profile-picture-container" (click)="triggerFileInput('perfil')">
      <img [src]="fotoPerfil || 'assets/default-profile.png'" alt="Foto de Usuario" class="profile-picture" />
      <span class="edit-icon">‚úèÔ∏è</span>
    </div>

    <!-- Detalles del Perfil -->
    <div class="profile-details">
      <h2>{{ psicologoName }}</h2>
      <p>
        <ng-container *ngIf="genero === 'femenino'; else masculino">
          Psic√≥loga
        </ng-container>
        <ng-template #masculino>
          Psic√≥logo
        </ng-template>
        Especialista en Salud Mental
      </p>
    </div>

    <!-- Bot√≥n para Cambiar Portada -->
    <button class="btn-change-background" (click)="triggerFileInput('portada')">‚úèÔ∏è</button>

    <!-- Inputs Ocultos para Subida de Archivos -->
    <input
  type="file"
  accept="image/*"
  (change)="onUpload($event, 'portada')"
  id="portada"
  style="display: none"
/>
<input
  type="file"
  accept="image/*"
  (change)="onUpload($event, 'perfil')"
  id="perfil"
  style="display: none"
/>

  </div>

  
  <!-- Secci√≥n de Recordatorios y Estad√≠sticas -->
  <div class="info-section">
    <div class="reminder-section">
      <h2>Recordatorios</h2>
      <div class="reminder-list">
        <div *ngIf="recordatorios.length > 0; else noRecordatorios">
          <div *ngFor="let cita of recordatorios" class="reminder-item">
            <div class="icon-container">
              <i class="fas fa-user-circle"></i>
            </div>
            <div class="reminder-text">
              <p class="reminder-title"><i class="fas fa-user"></i> Sesi√≥n con: <span>{{ cita.pacienteNombre }}</span></p>
              <p class="reminder-location"><i class="fas fa-map-marker-alt"></i> üó∫Ô∏è Ubicaci√≥n: <span>{{ cita.ubicacion }}</span></p>
              <p class="reminder-date">
                <i class="fas fa-calendar"></i> üìÖ Fecha: <span>{{ cita.fecha | date: 'dd/MM/yyyy' }}</span> 
                - <i class="fas fa-clock"></i> ‚åö Hora: <span>{{ cita.horaInicio }}</span>
              </p>
            </div>
          </div>
        </div>
        <ng-template #noRecordatorios>
          <p>No tienes citas programadas.</p>
        </ng-template>
      </div>
    </div>
    
    
  </div>

  <!-- Notas R√°pidas -->
  <div class="sticky-notes-container">
    <h2>Notas R√°pidas</h2>

    <!-- Formulario para A√±adir Notas -->
    <div class="add-note-form">
      <input type="text" [(ngModel)]="newNoteTitle" placeholder="T√≠tulo de la nota" />
      <textarea [(ngModel)]="newNoteContent" placeholder="Contenido de la nota"></textarea>
      <button (click)="addStickyNote()">A√±adir Nota</button>
    </div>

    <!-- Controles de Notas -->
    <div class="note-controls">
      <input type="text" placeholder="Buscar nota..." [(ngModel)]="searchQuery" (input)="filterNotes()" />
      <button (click)="sortNotes()">Ordenar Alfab√©ticamente</button>
    </div>

    <!-- Carrusel de Notas -->
    <div *ngIf="isCarouselActive" class="note-carousel">
      <button class="prev" (click)="prevNote()">‚Äπ</button>
      <div *ngFor="let note of filteredNotes; let i = index" class="sticky-note-carousel" [ngClass]="getCurrentNoteClass(i)">
        <h3>{{ note.title }}</h3>
        <p>{{ note.content }}</p>
      </div>
      <button class="next" (click)="nextNote()">‚Ä∫</button>
    </div>

    <!-- Lista de Notas -->
    <div *ngIf="!isCarouselActive" class="sticky-notes-list">
      <div *ngFor="let note of filteredNotes; let i = index" class="sticky-note-item">
        <h3>{{ note.title }}</h3>
        <p>{{ note.content }}</p>
        <button (click)="removeStickyNote(i)">Eliminar</button>
      </div>
    </div>
  </div>
</div>

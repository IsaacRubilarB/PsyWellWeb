<app-navbar></app-navbar>

<div class="resources-container">
  <h1>Recursos y Materiales</h1>

  <div class="categories">
    <div
      *ngFor="let item of sidebarItems"
      class="category-card"
      [ngClass]="{ 'active': selectedCategory === item.tipo }"
      (click)="selectCategory(item.tipo)"
    >
      <i class="material-icons">{{ item.icono }}</i>
      <h3>{{ item.titulo }}</h3>
    </div>
  </div>

  <div class="files-section">
    <h2>{{ getTitleForCategory(selectedCategory) }}</h2>
    <input
      type="text"
      placeholder="Buscar recurso..."
      [(ngModel)]="searchQuery"
      (input)="filterResources()"
    />
    <div *ngIf="filteredResources.length > 0" class="file-grid">
      <div *ngFor="let resource of filteredResources" class="file-card">
        <h4>{{ resource.titulo }}</h4>
        <p>{{ resource.descripcion }}</p>

        <!-- Video player -->
        <div *ngIf="resource.url" class="video-container">
          <iframe
            width="100%"
            height="200"
            [src]="resource.url | safe"
            frameborder="0"
            allowfullscreen
          ></iframe>
        </div>

        <button (click)="deleteResource(resource.id, selectedCategory)" class="delete-button">
          Eliminar
        </button>
      </div>
    </div>
    <p *ngIf="filteredResources.length === 0" class="no-data-message">
      No se encontraron recursos para esta categoría.
    </p>
    <button class="add-button" (click)="openModal()">
      Añadir Nuevo {{ getTitleForCategory(selectedCategory) }}
    </button>
  </div>
</div>

<!-- Modal para el formulario de agregar recurso -->
<div class="modal" *ngIf="isModalOpen">
  <div class="modal-content">
    <button class="close-modal" (click)="closeModal()">Cerrar</button>
    <app-formulario-recursos (resourceAdded)="fetchResources(selectedCategory)"></app-formulario-recursos>
  </div>
</div>

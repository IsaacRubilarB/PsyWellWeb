<app-navbar></app-navbar>

<div class="patient-details">
  <h1>Detalles del Paciente</h1>
  
  <div class="patient-profile">
    <img class="patient-photo" [src]="patientDetails.photo || 'assets/patient.png'" alt="Foto del paciente" />
    <div class="patient-info">
      <h2>{{ patientDetails.name }}</h2>
      <p><strong>Edad:</strong> {{ patientDetails.age }} Años</p>
      <p><strong>Diagnóstico:</strong> {{ patientDetails.diagnosis }}</p>
      <p><strong>Notas:</strong> {{ patientDetails.notes }}</p>
    </div>

    <button class="btn-open-modal" (click)="openFichaPacienteModal()">Abrir Ficha del Paciente</button>
  </div>

  <!-- Filtro para alternar entre datos -->
  <div class="data-filter">
    <h2>{{ showWeekly ? 'Data Semanal' : 'Data en Vivo' }}</h2>
    <button (click)="toggleDataView()" class="btn-toggle">
      {{ showWeekly ? 'Ver Data en Vivo' : 'Ver Data Semanal' }}
    </button>
  </div>
  
  <div class="charts-container">
    <div class="chart-wrapper">
      <div #heartAnimation class="lottie-animation"></div>
      <p class="bpm-display flip" [class.animate]="animateFlip">
        {{ showWeekly ? bpmWeekly : bpm }} BPM
      </p>
      <p>Frecuencia Cardíaca</p>
    </div>
  
    <div class="chart-wrapper">
      <div #saturationAnimation class="lottie-animation"></div>
      <p class="saturation-display flip" [class.animate]="animateFlip">
        {{ showWeekly ? saturationLevelWeekly : saturationLevel }} %
      </p>
      <p>Saturación de Oxígeno</p>
    </div>
  
    <div class="chart-wrapper">
      <div #stepsAnimation class="lottie-animation"></div>
      <p class="steps-display flip" [class.animate]="animateFlip">
        {{ showWeekly ? stepsWeekly : steps }}
      </p>
      <p>Pasos</p>
    </div>
  
    <div class="chart-wrapper">
      <div #sleepAnimation class="lottie-animation"></div>
      <p class="sleep-display flip" [class.animate]="animateFlip">
        {{ showWeekly ? sleepWeekly : sleep }} hrs
      </p>
      <p>Horas de Sueño</p>
    </div>
  </div>
  
  <app-reports
    [patientId]="patientId"
    [psychologistId]="psychologistId"
    [patientDetails]="patientDetails"
    [psychologistName]="psychologistName">
  </app-reports>

  <!-- Modal de Ficha del Paciente -->
  <div *ngIf="isFichaPacienteModalOpen" class="modal-container">
    <div class="modal-content">
      <app-ficha-paciente
        *ngIf="isFichaPacienteModalOpen"
        [patientId]="patientId"
        [psychologistId]="psychologistId"
        (closeModalEvent)="closeFichaPacienteModal()">
      </app-ficha-paciente>
    </div>
  </div>
</div>
